<!DOCTYPE html>
<html>
  <head>
     

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="generator" content="Yard v0.9.25">
<meta name="project" content="kit-organizer edge">


<title>Module: Kit::Organizer::Services::Organize — kit-organizer edge</title>

<link rel="stylesheet" href="assets/css/app-0f9f08c1bb297a76a4fe.css" />

<script>
  var yard_kit_relative_url_path = "";
</script>

<script src="sidebar_items-86d9e7bb48.js"></script>
<script src="docs_config.js"  ></script>
<script src="assets/js/app-8922f842956a6779307c.js"    async ></script>

  </head>

  <body data-type="modules">
    <script>
      try {
        let night_mode = localStorage.getItem('night-mode');
        if (night_mode === 'true' || night_mode === true) {
          document.body.className += ' night-mode';
        }
      } catch (e) {}
    </script>

    <div class="main">
      

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button">
      <span class="icon-cross" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Search" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    
      <a href="index.html">
        <img src="https://raw.githubusercontent.com/rubykit/kit/master/docs/assets/images/rubykit-framework-logo.svg" alt="kit-organizer" class="sidebar-projectImage">
      </a>
    
    <div class="sidebar-projectDetails">
      <a href="index.html" class="sidebar-projectName">
        kit-organizer
      </a>
      <h2 class="sidebar-projectVersion">
        edge
      </h2>
    </div>
  </div>

  <ul class="sidebar-listNav">
    <li>
      <a id="extras-list" href="#full-list">
        Guides
      </a>
    </li>
    
      <li>
        <a id="modules-list" href="#full-list">
          Modules
        </a>
      </li>
    
  </ul>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>


      <section class="content">
        <div class="content-outer">
          <div id="content" class="content-inner">

            
<small class="app-vsn"><b>kit-organizer</b> edge</small>

<h1 class='modules-header'>
  <div style='flex-grow: 1;'>

    <span class='title module-name'>Organize</span>
    <span class='object-type'>module</span>
    
      <div class='module-full-name'>Kit::Organizer::Services::Organize</div>
    
  </div>

  
    <a href="https://github.com/rubykit/kit/blob/master/libraries/kit-organizer/app/services/kit/organizer/services/organize.rb#L48" target='_blank' title="View Source" class="view-source" rel="help">
      <span class="icon-code" aria-hidden="true"></span>
      <span class="sr-only">View Source</span>
    </a>
  
</h1><section id="moduledoc">
  <div class='docstring-tags'>
  
</div><div class='docstring'>
  <p>Organizer passes the result of a callable to another callable (as long as the result is successfull).
It is mostly useful when you need to execute a series of operations resembling a pipeline.
You might alredy be familiar with some solutions that deal with this (Promises, Railway Programming, Pipe operators).
<code><span class='object_link'><a href="Kit.Organizer.html" title="Kit::Organizer (module)">Kit::Organizer</a></span></code> is a flavor of functional interactor.</p>

      <h3 id="introduction" class="section-heading">
        <a href="#introduction" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
        Introduction
      </h3>
    
<p>Describing a list of operations often leads to code that is difficult to follow or nested requires a lot of nesting. For instance:</p>

<pre><code class="ruby">fire_user_created_event(persist_user(validate_password(validate_email({ email: email, password: password }))))

# or

valid_email?    = validate_email(email)
valid_password? = validate_password(password)
if valid_email? &amp;&amp; valid_password?
  user = persist_user(email: email, password: password)
  if user
    fire_user_created_event(user: user)
  end
end
</code></pre>

<p>With <code>Organizer</code>, this is expressed as:</p>

<pre><code class="ruby">Kit::Organize::Services::Organize.call(
  list: [
    [:alias, :validate_email],
    [:alias, :validate_password],
    [:alias, :persist_user],
    [:alias, :fire_user_created_event],
  ],
  ctx: {
    email: &#39;&#39;,
    password: &#39;&#39;,
  },
)
</code></pre>

      <h4 id="context" class="section-heading">
        <a href="#context" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
        Context
      </h4>
    
<p>An organizer uses a context. The context contains everything the set of operations need to work.
When an operation is called, it can affect the context.</p>

      <h4 id="callable" class="section-heading">
        <a href="#callable" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
        Callable
      </h4>
    
<p>A callable is expected to return a result tupple of the following format:</p>

<pre><code class="ruby">[:ok] || [:ok, context_update] || [:error] || [:error, context_update]
</code></pre>


</div><div class="tags">
  

</div>
</section><hr>

<section id="summary" class="details-list">

   <h1 class="section-heading">
      <a class="hover-link" href="#summary">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this section</span>
      </a>
      Summary
      <span class='private-apis-warning unselectable'>⚠️ Private APIs are currently hidden.</span>
   </h1>

   
<div class="docstring-tags">

  

  
  
    
  
    
      <div class='doc-tag' data-ruby-Used instance mixins:='Kit::Contract::Mixin'>
        
          <span class='doc-tag-type'>Used instance mixins:</span>
          <span class='doc-tag-value'>Contract::Mixin</span>
        
      </div>
    
  
    
  
    
  

  
    <div class='doc-tag' data-ruby-files='app/services/kit/organizer/services/organize.rb#L48'>
      
        <span class='doc-tag-type'>Defined in:</span>
        <span class='doc-tag-value'>
          
          <a href="https://github.com/rubykit/kit/blob/master/libraries/kit-organizer/app/services/kit/organizer/services/organize.rb#L48" target='_blank' title="View Source" rel="help">
            app/services/kit/organizer/services/organize.rb#48
          </a>
        </span>
      
    </div>
  

</div>






  <div class="summary summary-methods-class">
    <h2 class='summary-heading'>
      <a href="#methods-class" class='title'>Class methods</a>
      <span class='list-count'>3</span>
    </h2>

    
      

<div class="summary-row" data-doc-type="method" data-tag-api="private">
  <a href="Kit.Organizer.Services.Organize.html#_log-class_method" title="_log (class method)">
    <div class="summary-signature">
      
      


<span class='scope'>.</span><span class='name'>_log</span><span class='arguments'>(txt, color = nil)</span><span class='block'></span>



      

      
      

<span class='docstring-tags'>
  
    <span class="docstring-tag" data-tag-api="private"><span class='docstring-tag-type'>API</span><span class='docstring-tag-value'>Private</span></span>
  
</span>

    </div>

    
      <div class="summary-synopsis"><p>Display debug information when `ENV['LOG_ORGANIZER']` is set.</p></div>
    
  </a>
</div>



    
      

<div class="summary-row" data-doc-type="method" >
  <a href="Kit.Organizer.Services.Organize.html#call-class_method" title="call (class method)">
    <div class="summary-signature">
      
      


<span class='scope'>.</span><span class='name'>call</span><span class='arguments'>(list:, ctx: {}, filter: nil)</span><span class='block'></span>



      

      
      

<span class='docstring-tags'>
  
</span>

    </div>

    
      <div class="summary-synopsis"><p>Run a `list` of `operations` (callable) in order.</p></div>
    
  </a>
</div>



    
      

<div class="summary-row" data-doc-type="method" data-tag-api="private" data-tag-example="sanitize_result([:error, ['Error1 detail', { detail: 'Error2 details' }]) => [:error, { errors: [{ detail: 'Error1 details' }, { detail: 'Error2 details' }] }]" data-tag-note="Enable simpler error return format from an organized callable.">
  <a href="Kit.Organizer.Services.Organize.html#sanitize_errors-class_method" title="sanitize_errors (class method)">
    <div class="summary-signature">
      
      


<span class='scope'>.</span><span class='name'>sanitize_errors</span><span class='arguments'>(result:)</span><span class='block'></span>



      

      
      

<span class='docstring-tags'>
  
    <span class="docstring-tag" data-tag-api="private"><span class='docstring-tag-type'>API</span><span class='docstring-tag-value'>Private</span></span>
  
</span>

    </div>

    
      <div class="summary-synopsis"><p>Sanitizes returned errors, if any.</p></div>
    
  </a>
</div>



    
  </div>














</section>


  <hr>

  <section id="methods-class" class="details-list">

    <h1 class="section-heading">
      <a class="hover-link" href="#methods-class">
        <span class="icon-link" aria-hidden="true"></span>
        <span class="sr-only">Link to this section</span>
      </a>
      Class methods
      <span class='list-count'>3</span>
      
        <span class='private-apis-warning unselectable'>⚠️ Private APIs are currently hidden.</span>
      
    </h1>

    <div class="functions-list">
      
        

<section class="detail" id="_log-class_method" data-tag-api="private">

  <div class="detail-header">

    <a href="Kit.Organizer.Services.Organize.html#_log-class_method" class="detail-link" title="Link to this method">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this method</span>
    </a>

    <h1 class="signature">
      
      


<span class='scope'>.</span><span class='name'>_log</span><span class='arguments'>(txt, color = nil)</span><span class='block'></span>


    </h1>

    <a href="https://github.com/rubykit/kit/blob/master/libraries/kit-organizer/app/services/kit/organizer/services/organize.rb#L148" target='_blank' rel="help" title="View Source" class='source-link'>
      <span class="icon-code" aria-hidden="true"></span>
      <span class="sr-only">View Source</span>
    </a>

    
    

<span class='docstring-tags'>
  
    <span class="docstring-tag" data-tag-api="private"><span class='docstring-tag-type'>API</span><span class='docstring-tag-value'>Private</span></span>
  
</span>


    <div class="specs" style='opacity: 1; margin-left: 15px; font-size: 0.8em; color: #777;'>
      <!-- TODO: add contracts here when we can generate documentation from them -->

      

      
    </div>

  </div>

  <section class="detail-body">
    <div class='docstring-tags'>
  <span class="docstring-tag">
  <strong><i>⚠️</i> This method is part of a private API.</strong>
  <span>You should avoid using it as it may be removed or be changed in the future.</span>
</span>
</div><div class='docstring'>
  <p>Display debug information when <code>ENV['LOG_ORGANIZER']</code> is set</p>


</div><div class="tags">
  

</div>
  </section>

</section>

      
        

<section class="detail" id="call-class_method" >

  <div class="detail-header">

    <a href="Kit.Organizer.Services.Organize.html#call-class_method" class="detail-link" title="Link to this method">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this method</span>
    </a>

    <h1 class="signature">
      
      


<span class='scope'>.</span><span class='name'>call</span><span class='arguments'>(list:, ctx: {}, filter: nil)</span><span class='block'></span>


    </h1>

    <a href="https://github.com/rubykit/kit/blob/master/libraries/kit-organizer/app/services/kit/organizer/services/organize.rb#L62" target='_blank' rel="help" title="View Source" class='source-link'>
      <span class="icon-code" aria-hidden="true"></span>
      <span class="sr-only">View Source</span>
    </a>

    
    

<span class='docstring-tags'>
  
</span>


    <div class="specs" style='opacity: 1; margin-left: 15px; font-size: 0.8em; color: #777;'>
      <!-- TODO: add contracts here when we can generate documentation from them -->

      

      
    </div>

  </div>

  <section class="detail-body">
    <div class='docstring-tags'>
  
</div><div class='docstring'>
  <p>Run a <code>list</code> of <code>operations</code> (callable) in order. Each results update the initial <code>ctx</code> which is then sent to the next operation.
An <code>operation</code> needs to be a callable, but it can be resolved from other format (see #to_callable)
Note: Every operation is expected to return a tupple of the format <code>[:ok]</code> or <code>[:error]</code> with an optional context update (<code>[:ok, { new_ctx_key: 'value' }]</code>, <code>[:errors, { errors: [{ detail: 'Error explaination' }], }]</code>). If an <code>:error</code> tupple is returned, the next operations are canceled and <code>call</code> will return.
contract Ct::Hash[list: Ct::Operations, ctx: Ct::Optional[Ct::Hash], filter: Ct::Optional[Ct::Or[Ct::Hash[ok: Ct::Array], Ct::Hash[error: Ct::Array]]]] =&gt; Ct::ResultTupple</p>


</div><div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>list</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>An array of operations (callables) that will be called in order</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ctx</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>A hash containing values to send to the operations (callables). It will be updated after every operation.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>filter</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Allows to slice specific keys on the context</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>The updated context.</p>
</div>
      
    </li>
  
</ul>

</div>
  </section>

</section>

      
        

<section class="detail" id="sanitize_errors-class_method" data-tag-api="private" data-tag-example="sanitize_result([:error, ['Error1 detail', { detail: 'Error2 details' }]) => [:error, { errors: [{ detail: 'Error1 details' }, { detail: 'Error2 details' }] }]" data-tag-note="Enable simpler error return format from an organized callable.">

  <div class="detail-header">

    <a href="Kit.Organizer.Services.Organize.html#sanitize_errors-class_method" class="detail-link" title="Link to this method">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this method</span>
    </a>

    <h1 class="signature">
      
      


<span class='scope'>.</span><span class='name'>sanitize_errors</span><span class='arguments'>(result:)</span><span class='block'></span>


    </h1>

    <a href="https://github.com/rubykit/kit/blob/master/libraries/kit-organizer/app/services/kit/organizer/services/organize.rb#L124" target='_blank' rel="help" title="View Source" class='source-link'>
      <span class="icon-code" aria-hidden="true"></span>
      <span class="sr-only">View Source</span>
    </a>

    
    

<span class='docstring-tags'>
  
    <span class="docstring-tag" data-tag-api="private"><span class='docstring-tag-type'>API</span><span class='docstring-tag-value'>Private</span></span>
  
</span>


    <div class="specs" style='opacity: 1; margin-left: 15px; font-size: 0.8em; color: #777;'>
      <!-- TODO: add contracts here when we can generate documentation from them -->

      

      
    </div>

  </div>

  <section class="detail-body">
    <div class='docstring-tags'>
  <span class="docstring-tag">
  <strong><i>⚠️</i> This method is part of a private API.</strong>
  <span>You should avoid using it as it may be removed or be changed in the future.</span>
</span><span class="docstring-tag">
  <span class='docstring-tag-type'><i>🗒</i> Notes:</span>
  <span class='docstring-tag-value'>
    <ul>
      
        <li>Enable simpler error return format from an organized callable.</li>
      
    </ul>
  </span>
</span>
</div><div class='docstring'>
  <p>Sanitizes returned errors, if any.
contract Ct::Hash[result: Ct::ResultTupple] =&gt; Ct::ResultTupple</p>


</div><div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Returning an error as a string</p>
</div></p>
      
      <pre class="example code"><code>sanitize_result([:error, &#39;Error details&#39;]) =&gt; [:error, { errors: [{ detail: &#39;Error details&#39; }] }]</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Returning an error as hash with detail</p>
</div></p>
      
      <pre class="example code"><code>sanitize_result([:error, { detail: &#39;Error details&#39; }]) =&gt; [:error, { errors: [{ detail: &#39;Error details&#39; }] }]</code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Returning an array of errors in the two former formats</p>
</div></p>
      
      <pre class="example code"><code>sanitize_result([:error, [&#39;Error1 detail&#39;, { detail: &#39;Error2 details&#39; }]) =&gt; [:error, { errors: [{ detail: &#39;Error1 details&#39; }, { detail: &#39;Error2 details&#39; }] }]</code></pre>
    
  </div>


</div>
  </section>

</section>

      
    </div>

  </section>






            <footer class="footer">

  <p>
    <span class="line">
      Built on 2020-06-21 by
      <a href="https://github.com/lsegal/yard" title="Yard" target="_blank" rel="help noopener">yard-0.9.25</a> with <a href="https://github.com/rubykit/kit/tree/master/libraries/kit-doc" title="Kit::Doc" target="_blank" rel="help noopener">Kit::Doc</a>,
    </span>
    <span class="line">
      designed by
      <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>
      for
      <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a>.
    </span>
  </p>

  <p>
    <button class="line footer-button display-shortcuts-help">
      Display keyboard shortcuts
    </button>
    <button class="line footer-button night-mode-toggle">
      Toggle night mode
    </button>
    <button class="line footer-button private-apis-toggle">
      Toggle private APIs display
    </button>
  </p>

</footer>

          </div>
        </div>
      </section>
    </div>
  </body>

</html>

